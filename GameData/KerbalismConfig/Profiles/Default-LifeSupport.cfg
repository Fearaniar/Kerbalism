// ============================================================================
// Add scrubber to all crewed parts
// ============================================================================

@PART[*]:HAS[#CrewCapacity[>0],!MODULE[KerbalSeat]]:NEEDS[ProfileDefault]:FOR[KerbalismDefault]
{
  MODULE
  {
    name = ModuleKsmProcessController
    uiGroup = #kerbalism-habitat
    id = scrubber
    resource = _Scrubber
    title = #KERBALISM_Scrubber_title // Scrubber
    desc = #KERBALISM_Scrubber_desc // Scrubber
    capacity = #$/CrewCapacity$
    running = true
  }
}

// ============================================================================
// Add pressure control to crewed command parts
// ============================================================================

@PART[*]:HAS[#CrewCapacity[>1],@MODULE[ModuleCommand]]:NEEDS[ProfileDefault]:FOR[KerbalismDefault]
{
  MODULE
  {
    name = ModuleKsmProcessController
    uiGroup = #kerbalism-habitat
    id = pressureControl
    resource = _PressureControl
    title = #KERBALISM_PressureControl_title
    desc = #KERBALISM_PressureControl_desc
    capacity = #$/CrewCapacity$
    @capacity *= 1.6 // add some extra for possibly attached parts
    running = true
  }
}

// ============================================================================
// Add scrubber process to EVA kerbals
// ============================================================================

@PART[kerbalEVA*]:HAS[@MODULE[ModuleTripLogger]]:NEEDS[ProfileDefault]:FOR[KerbalismDefault]
{
  MODULE
  {
    name = ModuleKsmProcessController
    id = scrubber-nonregen
    resource = _NonRegenScrubber
    title = #KERBALISM_NonRegenScrubber_title // Non-Regen Scrubber
    capacity = 1.0
    toggle = true
    running = true
  }
}
